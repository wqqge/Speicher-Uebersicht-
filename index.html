<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>DMX Operator 240 ‚Äì Speicher-Dokumentation</title>

<style>
body {
  font-family: Arial, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
  margin: 0;
  padding: 20px;
}
h1, h2 { color: #38bdf8; }
.container { max-width: 1400px; margin: auto; }

input, select {
  width: 100%;
  background: #020617;
  color: #e5e7eb;
  border: 1px solid #1e293b;
  padding: 6px;
}

table {
  width: 100%;
  border-collapse: collapse;
  margin-bottom: 20px;
  background: #020617;
}

th, td {
  border: 1px solid #1e293b;
  padding: 6px;
  vertical-align: top;
}

th {
  background: #020617;
  color: #7dd3fc;
  position: sticky;
  top: 0;
}

button {
  background: #38bdf8;
  color: #020617;
  border: none;
  padding: 8px 14px;
  font-size: 14px;
  border-radius: 8px;
  cursor: pointer;
  margin-right: 6px;
  margin-bottom: 6px;
}

button:hover { background: #0ea5e9; }

.toolbar {
  display: flex;
  gap: 10px;
  flex-wrap: wrap;
  margin-bottom: 10px;
}

.footer {
  opacity: 0.6;
  font-size: 13px;
  margin-top: 20px;
}

@media print {
  body { background: white; color: black; }
  button, .toolbar { display: none; }
  table { page-break-inside: avoid; }
  th { color: black; }
}
</style>
</head>

<body>
<div class="container">
<h1>DMX Operator 240 ‚Äì Speicher-Dokumentation</h1>

<div class="toolbar">
  <select id="projectSelect" onchange="loadProject()"></select>
  <input id="newProjectName" placeholder="Neues Projekt‚Ä¶" />
  <button onclick="createProject()">üìÅ Projekt anlegen</button>
  <button onclick="saveData()">üíæ Speichern</button>
  <button onclick="print()">üñ®Ô∏è Drucken</button>
  <input type="file" onchange="importJSON(event)" />
  <button onclick="exportJSON()">‚¨áÔ∏è Export</button>
  <input id="search" placeholder="üîç Suche‚Ä¶" oninput="filterTable()" />
</div>

<h2>Szenen / Cues</h2>

<button onclick="addSceneRow()">‚ûï Szene hinzuf√ºgen</button>

<table id="sceneTable">
<thead>
<tr>
  <th>Bank</th>
  <th>Szene</th>
  <th>Name / Cue</th>
  <th>Ger√§te</th>
  <th>Position / Platzierung</th>
  <th>Farbe / Bewegung / Werte</th>
  <th>Bemerkungen</th>
</tr>
</thead>
<tbody></tbody>
</table>

<button onclick="addSceneRow()">‚ûï Szene hinzuf√ºgen</button>

<h2>Chases / Lauflichter</h2>

<table id="chaseTable">
<thead>
<tr>
  <th>Chase</th>
  <th>Schritte</th>
  <th>Szenen / Reihenfolge</th>
  <th>Geschwindigkeit</th>
  <th>Modus</th>
  <th>Bemerkungen</th>
</tr>
</thead>
<tbody></tbody>
</table>

<p class="footer">
Offline nutzbar ¬∑ Daten lokal im Browser ¬∑ GitHub Pages kompatibel
</p>
</div>

<script>
let currentProject = 'default';

const positionOptions = [
  '',
  'FOH links', 'FOH mitte', 'FOH rechts',
  'B√ºhne links', 'B√ºhne mitte', 'B√ºhne rechts',
  'Traverse vorne', 'Traverse mitte', 'Traverse hinten',
  'Boden links', 'Boden rechts',
  'Portal oben',
  'Backlight',
  'Special / Effekt'
];

function createPositionSelect() {
  const select = document.createElement('select');
  positionOptions.forEach(p => {
    const opt = document.createElement('option');
    opt.value = p;
    opt.textContent = p || '‚Äî ausw√§hlen ‚Äî';
    select.appendChild(opt);
  });
  return select;
}

function addRow(tbody, cols, isScene = false) {
  const tr = document.createElement('tr');
  for (let i = 0; i < cols; i++) {
    const td = document.createElement('td');

    if (isScene && i === 4) {
      td.appendChild(createPositionSelect());
    } else {
      const input = document.createElement('input');
      td.appendChild(input);
    }

    tr.appendChild(td);
  }
  tbody.appendChild(tr);
}

function addSceneRow() {
  addRow(document.querySelector('#sceneTable tbody'), 7, true);
}

function initTables() {
  const sceneBody = document.querySelector('#sceneTable tbody');
  const chaseBody = document.querySelector('#chaseTable tbody');
  sceneBody.innerHTML = '';
  chaseBody.innerHTML = '';
  for (let i = 0; i < 10; i++) addSceneRow();
  for (let i = 0; i < 6; i++) addRow(chaseBody, 6);
}

function saveData() {
  const sceneValues = [];
  document.querySelectorAll('#sceneTable tbody tr').forEach(tr => {
    tr.querySelectorAll('input, select').forEach(el => {
      sceneValues.push(el.value);
    });
  });

  const chaseValues = [...document.querySelectorAll('#chaseTable input')].map(i => i.value);

  localStorage.setItem(
    'dmx240_' + currentProject,
    JSON.stringify({ scenes: sceneValues, chases: chaseValues })
  );
  alert('Gespeichert');
}

function loadData() {
  const data = JSON.parse(localStorage.getItem('dmx240_' + currentProject));
  if (!data) return;

  const sceneEls = document.querySelectorAll('#sceneTable input, #sceneTable select');
  sceneEls.forEach((el, idx) => el.value = data.scenes[idx] || '');

  document.querySelectorAll('#chaseTable input')
    .forEach((el, idx) => el.value = data.chases[idx] || '');
}

function exportJSON() {
  const data = localStorage.getItem('dmx240_' + currentProject);
  const blob = new Blob([data], { type: 'application/json' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = currentProject + '.json';
  a.click();
}

function importJSON(e) {
  const reader = new FileReader();
  reader.onload = evt => {
    localStorage.setItem('dmx240_' + currentProject, evt.target.result);
    initTables();
    loadData();
  };
  reader.readAsText(e.target.files[0]);
}

function filterTable() {
  const q = document.getElementById('search').value.toLowerCase();
  document.querySelectorAll('#sceneTable tbody tr').forEach(r => {
    r.style.display = r.innerText.toLowerCase().includes(q) ? '' : 'none';
  });
}

function loadProjectList() {
  const sel = document.getElementById('projectSelect');
  sel.innerHTML = '';
  Object.keys(localStorage)
    .filter(k => k.startsWith('dmx240_'))
    .forEach(k => {
      const name = k.replace('dmx240_', '');
      const opt = document.createElement('option');
      opt.value = name;
      opt.textContent = name;
      sel.appendChild(opt);
    });
}

function loadProject() {
  currentProject = document.getElementById('projectSelect').value;
  initTables();
  loadData();
}

function createProject() {
  const name = document.getElementById('newProjectName').value.trim();
  if (!name) return;
  currentProject = name;
  localStorage.setItem('dmx240_' + name, '{}');
  loadProjectList();
  document.getElementById('projectSelect').value = name;
  initTables();
}

initTables();
loadProjectList();
loadData();
</script>
</body>
</html>
