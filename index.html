<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>DMX Operator 240 ‚Äì Planung</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  font-family:Arial,sans-serif;
  background:#0f172a;
  color:#e5e7eb;
  margin:0;
  padding:20px;
}
h1,h2{color:#38bdf8}
.container{max-width:1500px;margin:auto}

input, select{
  width:100%;
  background:#020617;
  color:#e5e7eb;
  border:1px solid #1e293b;
  padding:6px;
}

button{
  background:#38bdf8;
  color:#020617;
  border:none;
  padding:6px 10px;
  border-radius:8px;
  cursor:pointer;
}
button:hover{background:#0ea5e9}

table{
  width:100%;
  border-collapse:collapse;
  background:#020617;
  margin-bottom:28px;
}
th,td{
  border:1px solid #1e293b;
  padding:6px;
  vertical-align:top;
}
th{color:#7dd3fc}

/* ===== Chase Steps ===== */
.step-table{
  width:100%;
  border-collapse:collapse;
}
.step-table th{
  font-size:12px;
}
.step-table td{
  font-size:12px;
}
.step-num{
  text-align:center;
  font-weight:bold;
  color:#38bdf8;
}
.scene-label{
  font-weight:bold;
}
.scene-name{
  color:#7dd3fc;
  font-size:11px;
}

/* B√ºhne */
#stage{
  width:100%;
  max-width:1000px;
  height:450px;
  background:#020617;
  border:2px dashed #38bdf8;
  border-radius:12px;
  position:relative;
  margin-bottom:30px;
}
.fixture{
  width:44px;
  height:44px;
  background:#38bdf8;
  color:#020617;
  border-radius:50%;
  position:absolute;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:11px;
  font-weight:bold;
}
</style>
</head>

<body>
<div class="container">

<h1>DMX Operator 240 ‚Äì Planung</h1>

<button onclick="downloadBackup()">‚¨áÔ∏è Backup herunterladen</button>
<button onclick="document.getElementById('importFile').click()">üìÇ Backup importieren</button>
<input type="file" id="importFile" accept=".json" hidden>

<h2>Szenen ‚Äì 30 B√§nke √ó 8 Szenen</h2>
<table>
<thead>
<tr>
  <th>Bank</th>
  <th>Szene</th>
  <th>Name</th>
  <th>Notizen</th>
</tr>
</thead>
<tbody id="sceneBody"></tbody>
</table>

<h2>Chases (Schrittfolge)</h2>
<table>
<thead>
<tr>
  <th>Name</th>
  <th>Schritte (Reihenfolge + Notizen)</th>
  <th>Speed</th>
  <th>Modus</th>
</tr>
</thead>
<tbody id="chaseBody"></tbody>
</table>

<button onclick="addChase()">‚ûï Chase</button>

</div>

<script>
/* ---------- Szenen ---------- */
const sceneBody=document.getElementById('sceneBody');
const sceneNames={};

for(let b=1;b<=30;b++){
  for(let s=1;s<=8;s++){
    const id=`B${b}S${s}`;
    sceneNames[id]='';

    const tr=document.createElement('tr');
    const nameInput=document.createElement('input');
    nameInput.dataset.scene=id;
    nameInput.oninput=()=>{
      sceneNames[id]=nameInput.value;
      updateStepNames();
    };

    tr.innerHTML=`
      <td>${b}</td>
      <td>${s}</td>
      <td></td>
      <td><input></td>
    `;
    tr.children[2].appendChild(nameInput);
    sceneBody.appendChild(tr);
  }
}

/* ---------- Chases ---------- */
const chaseBody=document.getElementById('chaseBody');

function sceneSelect(){
  const sel=document.createElement('select');
  Object.keys(sceneNames).forEach(id=>{
    const o=document.createElement('option');
    o.value=id;
    o.textContent=id;
    sel.appendChild(o);
  });
  return sel;
}

function addStep(tbody){
  const tr=document.createElement('tr');

  const sel=sceneSelect();
  const note=document.createElement('input');

  tr.innerHTML=`
    <td class="step-num"></td>
    <td></td>
    <td><input placeholder="Notiz"></td>
    <td><button onclick="this.closest('tr').remove(); renumber()">‚ùå</button></td>
  `;
  tr.children[1].appendChild(sel);
  tr.children[2].appendChild(note);
  tbody.appendChild(tr);
  updateStepNames();
  renumber();
}

function addChase(){
  const tr=document.createElement('tr');
  const steps=document.createElement('tbody');
  steps.className='steps';

  tr.innerHTML=`
    <td>
      <input placeholder="Chase Name"><br><br>
      <button onclick="addStep(this.closest('tr').querySelector('.steps'))">‚ûï Schritt</button>
    </td>
    <td>
      <table class="step-table">
        <thead>
          <tr>
            <th>#</th>
            <th>Szene</th>
            <th>Stichwort</th>
            <th></th>
          </tr>
        </thead>
        <tbody class="steps"></tbody>
      </table>
    </td>
    <td><input placeholder="Speed"></td>
    <td><input placeholder="Auto / Music"></td>
  `;
  chaseBody.appendChild(tr);
}

function updateStepNames(){
  document.querySelectorAll('.steps tr').forEach(tr=>{
    const sel=tr.querySelector('select');
    if(!sel)return;
    const id=sel.value;
    sel.options[sel.selectedIndex].text =
      `${id} ‚Äì ${sceneNames[id]||'(kein Name)'}`;
  });
}

function renumber(){
  document.querySelectorAll('.steps').forEach(t=>{
    [...t.children].forEach((r,i)=>{
      r.children[0].textContent=i+1;
    });
  });
}

/* ---------- Backup (vereinfachte Demo) ---------- */
function downloadBackup(){
  alert('Backup-Funktion bleibt kompatibel ‚Äì kann als N√§chstes erweitert werden');
}

/* Init */
addChase();
</script>
</body>
</html>
